function I(a){return document.getElementById(a)}var userLang=navigator.language||navigator.userLanguage,trans=[[]];trans.start=[],trans.start["en-US"]="Start",trans.abort=[],trans.abort["en-US"]="Abort",trans.response=[],trans.response["en-US"]="Response",trans.duration=[],trans.duration["en-US"]="Duration",trans.speed=[],trans.speed["en-US"]="Speed",trans.show_advanced=[],trans.show_advanced["en-US"]="Show advanced",trans.settings=[],trans.settings["en-US"]="Settings",trans.stats=[],trans.stats["en-US"]="Stats",trans.test_length=[],trans.test_length["en-US"]="Test length:",trans.time=[],trans.time["en-US"]="Time",trans.speed=[],trans.speed["en-US"]="Speed",trans.ip_address=[],trans.ip_address["en-US"]="IP Address:",trans.maximal_download=[],trans.maximal_download["en-US"]="Maximal download:",trans.maximal_upload=[],trans.maximal_upload["en-US"]="Maximal upload:",trans.minimal_download=[],trans.minimal_download["en-US"]="Minimal download:",trans.minimal_upload=[],trans.minimal_upload["en-US"]="Minimal upload:",trans.total_download=[],trans.total_download["en-US"]="Total download:",trans.total_upload=[],trans.total_upload["en-US"]="Total upload:",trans.show_detailed_a=[],trans.show_detailed_a["en-US"]="Show",trans.show_detailed_b=[],trans.show_detailed_b["en-US"]="detailed information about used algorithms.",trans.desc_ping=[],trans.desc_ping["en-US"]="Ping is measured as a response time for a HTTP request. Multiple requests are sent in 100 ms intervals. The graph shows response times for individual requests. The time values are preferably obtained from the JavaScript Performance API. If this API is not supported in the user's web browser, the JavaScript Date().getTime() function is used, which however provides less precise values.",trans.desc_jitter=[],trans.desc_jitter["en-US"]="Jitter is computed as a standard deviation of all ping values measured up to the given time. A more representative value is therefore indicated at the end of the measurement.",trans.desc_down_up=[],trans.desc_down_up["en-US"]="Download and upload are measured by transferring blocks of data by HTTP requests. The bandwidth is computed from HTTP payload data transferred (without HTTP and lower layer headers). The graph shows an arithmetic mean of all values measured up to the given time. A more representative value for large file transfers is therefore indicated at the end of the measurement.",trans.desc_final=[],trans.desc_final["en-US"]="The final number indicated in gauges is an average value for all pings and a value at the end of the measurement for the other characteristics.",trans.desc_origin=[],trans.desc_origin["en-US"]="Original speedtest source code can be obtained at ",trans.desc_questions=[],trans.desc_questions["en-US"]="For any questions regarding speedtest, please contact us on email: melnikov (at) cesnet.cz.",trans.abort["cs-CZ"]="Zru\u0161it",trans.response["cs-CZ"]="Odezva",trans.duration["cs-CZ"]="Pr\u016Fb\u011Bh",trans.show_advanced["cs-CZ"]="Pokro\u010Dil\xE9 nastaven\xED",trans.settings["cs-CZ"]="Nastaven\xED",trans.test_length["cs-CZ"]="D\xE9lka testu:",trans.stats["cs-CZ"]="Statistiky",trans.time["cs-CZ"]="\u010Cas",trans.speed["cs-CZ"]="Rychlost",trans.ip_address["cs-CZ"]="IP Adresa:",trans.maximal_download["cs-CZ"]="Maxim\xE1ln\xED download:",trans.maximal_upload["cs-CZ"]="Maxim\xE1ln\xED upload:",trans.minimal_download["cs-CZ"]="Minim\xE1ln\xED download:",trans.minimal_upload["cs-CZ"]="Minim\xE1ln\xED upload:",trans.total_download["cs-CZ"]="Celkov\xFD download:",trans.total_upload["cs-CZ"]="Celkov\xFD upload:",trans.show_detailed_a["cs-CZ"]="Zobrazit",trans.show_detailed_b["cs-CZ"]="detailn\xED informace o pou\u017Eit\xFDch algoritmech.",trans.desc_ping["cs-CZ"]="Ping je m\u011B\u0159en jako \u010Das odezvy na po\u017Eadavek protokolu HTTP. Je odesl\xE1na \u0159ada po\u017Eadavk\u016F v intervalu 100 ms. V grafu jsou zobrazeny \u010Dasy odezvy na jednotliv\xE9 po\u017Eadavky. \u010Casov\xE9 hodnoty jsou prioritn\u011B z\xEDsk\xE1v\xE1ny z Javascript Performance API. Pokud toto rozhran\xED nen\xED ve Va\u0161em webov\xE9m prohl\xED\u017Ee\u010Di podporov\xE1no, je pou\u017Eita Javascript funkce Date().getTime(), kter\xE1 ale poskytuje m\xE9n\u011B p\u0159esn\xE9 hodnoty.",trans.desc_jitter["cs-CZ"]="Jitter je po\u010D\xEDt\xE1n jako sm\u011Brodatn\xE1 odchylka v\u0161ech nam\u011B\u0159en\xFDch hodnot pingu a\u017E do dan\xE9ho \u010Dasu. Reprezentativn\u011Bj\u0161\xED hodnota je tedy zobrazena na konci m\u011B\u0159en\xED.",trans.desc_down_up["cs-CZ"]="Download a upload jsou m\u011B\u0159eny p\u0159enosem blok\u016F dat pomoc\xED protokolu HTTP. Kapacita je po\u010D\xEDt\xE1na z p\u0159enesen\xFDch u\u017Eivatelsk\xFDch dat (bez hlavi\u010Dek HTTP a hlavi\u010Dek ni\u017E\u0161\xEDch vrstev). Graf zobrazuje aritmetick\xFD pr\u016Fm\u011Br v\u0161ech hodnot nam\u011B\u0159en\xFDch a\u017E do dan\xE9ho \u010Dasu. Reprezentativn\u011Bj\u0161\xED hodnota pro p\u0159enosy velk\xFDch soubor\u016F je tedy zobrazena na konci m\u011B\u0159en\xED.",trans.desc_final["cs-CZ"]="Kone\u010Dn\xE9 hodnoty uveden\xE9 uprost\u0159ed grafick\xFDch indik\xE1tor\u016F jsou pr\u016Fm\u011Brn\xE1 hodnota pro v\u0161echny pingy a hodnota na konci m\u011B\u0159en\xED pro ostatn\xED charakteristiky.",trans.desc_origin["cs-CZ"]="Zdrojov\xE9 k\xF3dy p\u016Fvodn\xEDho speedtestu jsou k dispozici na serveru ";function tr(a){return void 0===trans[a][userLang]?void 0===trans[a]["en-US"]?"unknown translation":trans[a]["en-US"]:trans[a][userLang]}function trw(a){document.write(tr(a))}var chart1,chart2,last_chart_pos,meterBk="#E0E0E0",dlColor="#6060AA",ulColor="#309030",pingColor="#ffcc00",jitColor="#cc0000",progColor="#EEEEEE",w=null,sampling=!1,data=null,timers=[],parameters={overheadCompensationFactor:1,enable_quirks:!0,time_ul:15,time_dl:15,time_ulGraceTime:3,time_dlGraceTime:1.5},max_upload=0,min_upload=0,max_download=0,min_download=0,total_upload=0,total_download=0,ping_sum=0,ping_cnt=.001;function drawMeter(a,b,c,d,e,f){var g=Math.PI,h=a.getContext("2d"),i=window.devicePixelRatio||1,j=a.clientWidth*i,k=a.clientHeight*i,l=.0055*k;a.width==j&&a.height==k?h.clearRect(0,0,j,k):(a.width=j,a.height=k),h.beginPath(),h.strokeStyle=c,h.lineWidth=16*l,h.arc(a.width/2,a.height-58*l,a.height/1.8-h.lineWidth,1.1*-g,.1*g),h.stroke(),h.beginPath(),h.strokeStyle=d,h.lineWidth=16*l,h.arc(a.width/2,a.height-58*l,a.height/1.8-h.lineWidth,1.1*-g,1.2*(b*g)-1.1*g),h.stroke(),"undefined"!=typeof e&&(h.fillStyle=f,h.fillRect(.3*a.width,a.height-16*l,.4*a.width*e,4*l))}function mbpsToAmount(a){return 1-1/Math.pow(1.3,Math.sqrt(a))}function msToAmount(a){return 1-1/Math.pow(1.08,Math.sqrt(a))}function oscillate(){return 1+.02*Math.sin(Date.now()/100)}function initUI(){drawMeter(I("dl_meter"),0,meterBk,dlColor,0),drawMeter(I("ul_meter"),0,meterBk,ulColor,0),drawMeter(I("ping_meter"),0,meterBk,pingColor,0),drawMeter(I("jitter_meter"),0,meterBk,jitColor,0),I("dl_text").textContent="",I("ul_text").textContent="",I("ping_text").textContent="",I("jitter_text").textContent="",I("ip").textContent="?";var a=document.getElementById("chart_du_area").getContext("2d"),b=document.getElementById("chart_pj_area").getContext("2d"),c={type:"line",data:{datasets:[{label:"Download",fill:!1,lineTension:.1,backgroundColor:"rgba(96,96,170,0.5)",borderColor:"rgba(96,96,170,1)",borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",pointBorderColor:"rgba(96,96,170,1)",pointBackgroundColor:"#fff",pointBorderWidth:1,pointHoverRadius:0,pointHoverBackgroundColor:"rgba(96,96,170,1)",pointHoverBorderColor:"rgba(220,220,220,1)",pointHoverBorderWidth:2,pointRadius:1,pointHitRadius:10,data:[0],spanGaps:!1},{label:"Upload",fill:!1,lineTension:.1,backgroundColor:"rgba(48,144,48,0.5)",borderColor:"rgba(48,144,48,1)",borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",pointBorderColor:"rgba(48,144,48,1)",pointBackgroundColor:"#fff",pointBorderWidth:1,pointHoverRadius:0,pointHoverBackgroundColor:"rgba(48,144,48,1)",pointHoverBorderColor:"rgba(220,220,220,1)",pointHoverBorderWidth:2,pointRadius:1,pointHitRadius:10,data:[0],spanGaps:!1}]},options:{responsive:!0,tooltips:{enabled:!1},legend:{position:"top"},scales:{xAxes:[{display:!0,scaleLabel:{display:!0,labelString:tr("duration")+" (s)"},ticks:{beginAtZero:!0}}],yAxes:[{display:!0,scaleLabel:{display:!0,labelString:tr("speed")+" (Mbps)"},ticks:{beginAtZero:!0}}]}}},d={type:"line",data:{datasets:[{label:"Ping",fill:!1,lineTension:.1,backgroundColor:"rgba(255,204,0,0.5)",borderColor:"rgba(255,204,0,1)",borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",pointBorderColor:"rgba(255,204,0,1)",pointBackgroundColor:"#fff",pointBorderWidth:1,pointHoverRadius:0,pointHoverBackgroundColor:"rgba(75,220,75,1)",pointHoverBorderColor:"rgba(220,220,220,1)",pointHoverBorderWidth:2,pointRadius:1,pointHitRadius:10,data:[],spanGaps:!1},{label:"Jitter",fill:!1,lineTension:.1,backgroundColor:"rgba(204,0,0,0.5)",borderColor:"rgba(204,0,0,1)",borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",pointBorderColor:"rgba(204,0,0,1)",pointBackgroundColor:"#fff",pointBorderWidth:1,pointHoverRadius:0,pointHoverBackgroundColor:"rgba(220,75,75,1)",pointHoverBorderColor:"rgba(220,220,220,1)",pointHoverBorderWidth:2,pointRadius:1,pointHitRadius:10,data:[],spanGaps:!1}]},options:{responsive:!0,tooltips:{enabled:!1},legend:{position:"top"},scales:{xAxes:[{display:!0,scaleLabel:{display:!0,labelString:tr("duration")+" (ms)"},ticks:{beginAtZero:!0}}],yAxes:[{display:!0,scaleLabel:{display:!0,labelString:tr("response")+" (ms)"},ticks:{beginAtZero:!0}}]}}};chart1!==void 0&&chart1.destroy(),chart2!==void 0&&chart2.destroy(),chart1=new Chart(a,c),chart2=new Chart(b,d),$("#results_table_download").html("<tr><th>"+tr("time")+" (s)</th><th>"+tr("speed")+" (Mbps)</th></tr>"),$("#results_table_upload").html("<tr><th>"+tr("time")+" (s)</th><th>"+tr("speed")+" (Mbps)</th></tr>"),$("#stats_table").html(""),max_download=0,min_download=0,max_upload=0,min_upload=0,total_download=0,total_upload=0,$("#length").val(parameters.time_dl)}$(document).ready(function(){$("#show_advanced").click(function(){$("#advanced").slideToggle(300)}),$("#show_speedtest_info").click(function(){$("#speedtest_info").slideToggle(300)})});function updateUI(a){if(a||data&&w){var b=+data[0];if(I("ip").textContent=data[4],I("dl_text").textContent=1==b&&0==data[1]?"...":data[1],drawMeter(I("dl_meter"),mbpsToAmount(+(data[1]*(1==b?oscillate():1))),meterBk,dlColor,+data[6],progColor),I("ul_text").textContent=3==b&&0==data[2]?"...":data[2],drawMeter(I("ul_meter"),mbpsToAmount(+(data[2]*(3==b?oscillate():1))),meterBk,ulColor,+data[7],progColor),2==b&&0<+data[3]&&(ping_sum+=+data[3],ping_cnt++),I("ping_text").textContent=(ping_sum/ping_cnt).toFixed(2),drawMeter(I("ping_meter"),msToAmount(+(ping_sum/ping_cnt*(2==b?oscillate():1))),meterBk,pingColor,+data[8],progColor),I("jitter_text").textContent=data[5],drawMeter(I("jitter_meter"),msToAmount(+(data[5]*(2==b?oscillate():1))),meterBk,jitColor,+data[8],progColor),1==b&&0<+data[1]){let a=~~(parameters.time_dl*+data[6]);chart1.data.datasets[0].data[a]=+data[1],chart1.data.labels[chart1.data.datasets[0].data.length-1]=a,chart1.update(),last_chart_pos!=a&&0!=a&&($("#results_table_download").append("<tr><td>"+a+"</td><td>"+ +data[1]+"</td></tr>"),(+data[1]>max_download||0>=max_download)&&(max_download=+data[1]),(+data[1]<min_download||0>=min_download)&&(min_download=+data[1]),total_download=data[9],updateStats(),last_chart_pos=a)}if(3==b&&0<+data[2]){let a=~~(parameters.time_ul*+data[7]);chart1.data.datasets[1].data[a]=+data[2],chart1.data.labels[chart1.data.datasets[1].data.length-1]=a,chart1.update(),last_chart_pos!=a&&0!=a&&($("#results_table_upload").append("<tr><td>"+a+"</td><td>"+ +data[2]+"</td></tr>"),last_chart_pos=a,(+data[1]>max_upload||0>=max_upload)&&(max_upload=+data[2]),(+data[1]<min_upload||0>=min_upload)&&(min_upload=+data[2]),total_upload=data[10],updateStats())}2==b&&0<+data[3]&&(chart2.data.datasets[0].data.push(+data[3]),chart2.data.datasets[1].data.push(+data[5]),chart2.data.labels[chart2.data.datasets[0].data.length-1]="",chart2.data.labels[chart2.data.datasets[1].data.length-1]=100*Math.round(data[11]/100),chart2.update())}}function updateStats(){var a=Math.round;$("#stats_table").html("        <tr><th>"+tr("minimal_download")+"</th><td>"+min_download+" Mbps</td></tr>        <tr><th>"+tr("maximal_download")+"</th><td>"+max_download+" Mbps</td></tr>        <tr><th>"+tr("minimal_upload")+"</th><td>"+min_upload+" Mbps</td></tr>        <tr><th>"+tr("maximal_upload")+"</th><td>"+max_upload+" Mbps</td></tr>        <tr><th>"+tr("total_download")+"</th><td>"+a(total_download/1024/1024)+" MB</td></tr>        <tr><th>"+tr("total_upload")+"</th><td>"+a(total_upload/1024/1024)+" MB</td></tr>        ")}function startStop(){if(null!=w)w.postMessage("abort"),resetUI(),initUI();else{let a=parseInt($("#length").attr("min")),b=parseInt($("#length").attr("max")),c=parseInt($("#length").val());c<a&&(c=a),c>b&&(c=b),parameters.time_dl=c,parameters.time_ul=c,initUI(),w=new Worker("speedtest_worker.min.js"),w.postMessage("start "+JSON.stringify(parameters)),I("startStopBtn").className="btn disabled",I("startStopBtn").innerHTML=tr("abort"),setTimeout(function(){I("startStopBtn").className="btn running"},1500),w.onmessage=function(a){data=a.data.split(";");var b=+data[0];timers[1]==null&&1==b&&(timers[1]=performance.now()),timers[2]==null&&2==b&&(timers[2]=performance.now()),timers[3]==null&&3==b&&(timers[3]=performance.now()),4<=b?(resetUI(),updateUI(!0)):(data[11]=performance.now()-timers[b],updateUI())}}}function resetUI(){I("startStopBtn").className="btn",I("startStopBtn").innerHTML=tr("start"),w=null,sampling=!1,delete timers[1],delete timers[2],delete timers[3]}window.addEventListener("focus",function(){data||(data=["0","","","","","","0","0","0",0]),updateUI(!0),chart1.update(),chart2.update()},!1);